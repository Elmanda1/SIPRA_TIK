generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model users {
  id_user Int             @id @default(autoincrement())
  uname   String          @db.VarChar(50)
  email   String          @unique @db.VarChar(255)
  pw      String          @db.VarChar(100)
  role    role_enum
  barang  inven_barang[]  @relation("UserBarang")
  ruangan inven_ruangan[] @relation("UserRuangan")
  pinjam  peminjaman[]    @relation("UserPinjam")
}

model inven_barang {
  id_barang   Int          @id @default(autoincrement())
  nama_barang String       @db.VarChar(255)
  jml_barang  Int
  lokasi      String?      @db.VarChar(100)
  detail      String       @db.VarChar(100)
  status      status_inven
  id_user     Int?
  user        users?       @relation("UserBarang", fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction)
  pinjam      peminjaman[] @relation("BarangPinjam")
}

model inven_ruangan {
  id_ruangan   Int          @id @default(autoincrement())
  kode_ruangan String       @db.VarChar(20)
  detail       String       @db.VarChar(100)
  status       status_inven
  id_user      Int?
  user         users?       @relation("UserRuangan", fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction)
  pinjam       peminjaman[] @relation("RuanganPinjam")
}

model peminjaman {
  id_peminjaman        Int            @id @default(autoincrement())
  tanggal_pengajuan    DateTime      @default(now()) @db.Timestamp(6)
  tanggal_peminjaman   DateTime       @db.Timestamp(6)
  tanggal_pengembalian DateTime       @db.Timestamp(6)
  status               String         @db.VarChar(20)
  id_user              Int
  id_barang            Int?
  id_ruangan           Int?
  barang               inven_barang?  @relation("BarangPinjam", fields: [id_barang], references: [id_barang], onDelete: NoAction, onUpdate: NoAction)
  ruangan              inven_ruangan? @relation("RuanganPinjam", fields: [id_ruangan], references: [id_ruangan], onDelete: NoAction, onUpdate: NoAction)
  user                 users          @relation("UserPinjam", fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction)
}

enum role_enum {
  admin
  dosen
  mahasiswa
}

enum status_inven {
  diajukan
  diterima
  ditolak
}
